---
date: 2025-11-07
authors:
  - jerry
categories:
  - Blog
tags:
  - control
---

# 1.1 系统能控性与能观性

本文将从动态系统分析与状态估计的视角，深入探讨线性系统的稳定性、能控性与能观性这三个基本结构特性。这些概念构成了现代控制理论的基石，对于系统综合设计与状态估计器的构建具有根本性意义。

<!-- more -->

## 1. 线性系统稳定性分析

考虑离散时间线性时不变系统 $x_{k+1} = \mathbf{A} x_k$，其中状态向量 $x\in \mathbb{R}^n$，系统矩阵 $\mathbf{A} \in \mathbb{R}^{n \times n}$。该系统被定义为稳定，更准确地说，是渐近稳定的条件为：

$$
\lim_{k \to \infty} x_k = 0, \quad \forall x_0
$$

值得注意的是，系统的稳定性等价于以下重要判据：系统矩阵 $\mathbf{A}$ 的所有特征值均具有负实部，即：

$$
\text{Re}(\lambda_i) < 0, \quad i = 1, 2, \ldots, n
$$

!!! abstract "证明"

    设 $\mathbf{A}$ 的特征值为 $\lambda_i$，对应的特征向量为 $v_i$。则状态转移矩阵可表示为：

    $$
    \mathbf{\Phi}(t) = \sum_{i=1}^{n} e^{\lambda_i t} v_i v_i^T
    $$

    当 $\text{Re}(\lambda_i) < 0$ 时，显然有 $e^{\lambda_i t} \to 0$ 当 $t \to \infty$。因此，对于任意初始状态 $x_0$，系统状态 $x(t) = \mathbf{\Phi}(t)x_0$ 也将趋于零，证明完毕。

当系统矩阵的特征值均位于复平面的左半开平面时，状态转移矩阵的各个模态分量将随时间呈指数衰减，从而保证系统状态的渐近收敛性。

## 2. 系统能控性理论

离散线性系统 $x_{k+1} = \mathbf{A} x_k + \mathbf{B} u_k$ 被定义为完全能控的条件是：对于任意初始状态 $x_0$ 和任意目标状态 $x_f$，存在有限时间 $N$ 和输入序列 $\{u_0, u_1, \ldots, u_{N-1}\}$，使得系统能够从 $x_0$ 转移到 $x_N=x_f$。

我们可以展开系统状态在 $N$ 步后的表达式：

$$
\begin{aligned}
x_N &= \mathbf{A}x_{n-1} + \mathbf{B}u_{N-1} \\
    &= \mathbf{A}^2 x_{N-2} + \mathbf{A}\mathbf{B}u_{N-2} + \mathbf{B}u_{N-1} \\
    &\;\;\vdots \\
    &= \mathbf{A}^N x_0 + \sum_{i=0}^{N-1} \mathbf{A}^{N-1-i} \mathbf{B} u_i \\
    &= \mathbf{A}^N x_0 + \begin{bmatrix} \mathbf{A}^N \mathbf{B} & \mathbf{A}^{N-1} \mathbf{B} & \cdots & \mathbf{B} \end{bmatrix} \begin{bmatrix} u_0 \\ u_1 \\ \vdots \\ u_{N-1} \end{bmatrix}
\end{aligned}
$$

其中 $\begin{bmatrix} \mathbf{A}^N \mathbf{B} & \mathbf{A}^{N-1} \mathbf{B} & \cdots & \mathbf{B} \end{bmatrix}$ 称为系统的能控矩阵，记作 $\mathcal{M}_C$。当 $\text{rank}(\mathcal{M}_C) = n$ 时，对于任意目标状态 $x_f$，可通过求解线性方程组：

$$
\begin{bmatrix} u_0 \\ u_1 \\ \vdots \\ u_{N-1} \end{bmatrix} = \mathcal{M}_C^\top(\mathcal{M}_C \mathcal{M}_C^\top)^{-1} (x_f - \mathbf{A}^N x_0)
$$

得到相应的控制序列 $\{u_0, u_1, \ldots, u_{N-1}\}$，**其中控制序列的存在性由 $\mathcal{M}_C$ 满秩保证**，由此我们得到了第一个能控性判据。

!!! note "能控性判据"

    离散线性系统 $x_{k+1} = \mathbf{A} x_k + \mathbf{B} u_k$ 完全能控的充分必要条件是其能控矩阵 $\mathcal{M}_C$ 满秩，即 $\text{rank}(\mathcal{M}_C) = n$。

或者我们可以通过 $\mathcal{M}_C \mathcal{M}_C^\top$ ，称为系统的能控格拉姆矩阵 $\mathbf{W}_c$，来判定系统的能控性。当 $\mathbf{W}_c$ 为正定矩阵时，系统同样是完全能控的。这意味着输入能够充分影响系统的所有状态变量，**或者说 $\mathcal{M}_c$ 列向量张成的能控子空间为整个状态空间 $\mathbb{R}^n$**。

!!! note "格拉姆判据"

    离散线性系统 $x_{k+1} = \mathbf{A} x_k + \mathbf{B} u_k$ 完全能控的充分必要条件是其格拉姆矩阵 $\mathbf{W}_C = \sum_{i=0}^{n-1} \mathbf{A}^i \mathbf{B} \mathbf{B}^\top (\mathbf{A}^\top)^i$ 为正定矩阵。

还有一种基于系统特征值与特征向量的能控性判据，称为 PBH 判据。若对某个特征值 $\lambda$，存在一个对应的左特征向量 $v^\top$ 使得 $v^\top \mathbf{A} = \lambda v^\top$ 且 $v^\top \mathbf{B} = 0$，这意味着该模态无法被任何输入激发，此时 $[A - \lambda I, \; B]$ 不满秩，系统即不可控。反之，若对于所有特征值 $\lambda$，矩阵 $[A - \lambda I, \; B]$ 均满秩，则系统完全能控。

!!! note "PBH 判据"

    离散线性系统 $x_{k+1} = \mathbf{A} x_k + \mathbf{B} u_k$ 完全能控的充分必要条件是对于任意特征值 $\lambda\in\mathbb{C}$, $[A - \lambda I, \; B]$ 满秩。

## 3. 系统能观性理论

离散线性系统 $x_{k+1} = \mathbf{A} x_k$，输出方程为 $y_k = \mathbf{C} x_k$。系统被定义为完全能观的条件是：对于任意初始状态 $x_0$，通过有限时间内的输出序列 $\{y_0, y_1, \ldots, y_{N-1}\}$，能够唯一确定 $x_0$。展开输出序列的表达式：

$$
\begin{aligned}
y_k &= \mathbf{C} x_k \\
    &= \mathbf{C} \mathbf{A} x_{k-1} \\
    &= \mathbf{C} \mathbf{A}^2 x_{k-2} \\
    &\;\;\vdots \\
    &= \mathbf{C} \mathbf{A}^{k} x_0
\end{aligned}
$$

将前 $N$ 步的输出堆叠起来：

$$
\begin{bmatrix}
y_0 \\
y_1 \\
\vdots \\
y_{N-1}
\end{bmatrix}
=
\begin{bmatrix}
\mathbf{C} \mathbf{A}^0 \\
\mathbf{C} \mathbf{A}^1 \\
\vdots \\
\mathbf{C} \mathbf{A}^{N-1}
\end{bmatrix}
x_0
$$

其中 $\begin{bmatrix} \mathbf{C} \mathbf{A}^0 \\ \mathbf{C} \mathbf{A}^1 \\ \vdots \\ \mathbf{C} \mathbf{A}^{N-1} \end{bmatrix}$ 称为系统的能观矩阵，记作 $\mathcal{M}_O$。当 $\text{rank}(\mathcal{M}_O) = n$ 时，初始状态 $x_0$ 可以通过求解线性方程组：

$$
x_0 = (\mathcal{M}_O^\top \mathcal{M}_O)^{-1} \mathcal{M}_O^\top \begin{bmatrix} y_0 \\ y_1 \\ \vdots \\ y_{N-1} \end{bmatrix}
$$

得到，**其中初始状态的唯一性由 $\mathcal{M}_O$ 满秩保证**，由此我们得到了第一个能观性判据。

!!! note "能观性判据"

    离散线性系统 $x_{k+1} = \mathbf{A} x_k, \; y_k = \mathbf{C} x_k$ 完全能观的充分必要条件是其能观矩阵 $\mathcal{M}_O$ 满秩，即 $\text{rank}(\mathcal{M}_O) = n$。

或者我们可以通过 $\mathcal{M}_O^\top \mathcal{M}_O$ ，称为系统的能观格拉姆矩阵 $\mathbf{W}_o$，来判定系统的能观性。当 $\mathbf{W}_o$ 为正定矩阵时，系统同样是完全能观的。这意味着所有状态变量的信息均能通过输出被观测到，**或者说 $\mathcal{M}_O$ 行向量张成的能观子空间为整个状态空间 $\mathbb{R}^n$**。

!!! note "格拉姆判据"

    离散线性系统 $x_{k+1} = \mathbf{A} x_k, \; y_k = \mathbf{C} x_k$ 完全能观的充分必要条件是其格拉姆矩阵 $\mathbf{W}_O = \sum_{i=0}^{n-1} (\mathbf{A}^\top)^i \mathbf{C}^\top \mathbf{C} \mathbf{A}^i$ 为正定矩阵。

还有一种基于系统特征值与特征向量的能观性判据，称为 PBH 判据。若对某个特征值 $\lambda$，存在一个对应的右特征向量 $v$ 使得 $\mathbf{A} v = \lambda v$ 且 $\mathbf{C} v = 0$，这意味着该模态无法通过任何输出被观测到，此时 $\begin{bmatrix} \mathbf{A} - \lambda I \\ \mathbf{C} \end{bmatrix}$ 不满秩，系统即不可观。反之，若对于所有特征值 $\lambda$，矩阵 $\begin{bmatrix} \mathbf{A} - \lambda I \\ \mathbf{C} \end{bmatrix}$ 均满秩，则系统完全能观。

!!! note "PBH 判据"

    离散线性系统 $x_{k+1} = \mathbf{A} x_k, \; y_k = \mathbf{C} x_k$ 完全能观的充分必要条件是对于任意特征值 $\lambda\in\mathbb{C}$, $\begin{bmatrix} \mathbf{A} - \lambda I \\ \mathbf{C} \end{bmatrix}$ 满秩。

## 4. 控制器与观测器的对偶关系

|            |                                              能控性                                               |                                                            能观性                                                            |
| :--------: | :-----------------------------------------------------------------------------------------------: | :--------------------------------------------------------------------------------------------------------------------------: |
|    系统    |                            $x_{k+1} = \mathbf{A} x_k + \mathbf{B} u_k$                            |                                     $x_{k+1} = \mathbf{A} x_k, \; y_k = \mathbf{C} x_k$                                      |
|    矩阵    | $\mathcal{M}_C = \begin{bmatrix} \mathbf{A}^{N-1} \mathbf{B} & \cdots & \mathbf{B} \end{bmatrix}$ | $\mathcal{M}_O = \begin{bmatrix} \mathbf{C} \\ \mathbf{C} \mathbf{A} \\ \vdots \\ \mathbf{C} \mathbf{A}^{N-1} \end{bmatrix}$ |
| 格拉姆矩阵 |   $\mathbf{W}_C = \sum_{i=0}^{n-1} \mathbf{A}^i \mathbf{B} \mathbf{B}^\top (\mathbf{A}^\top)^i$   |                $\mathbf{W}_O = \sum_{i=0}^{n-1} (\mathbf{A}^\top)^i \mathbf{C}^\top \mathbf{C} \mathbf{A}^i$                 |
|  PBH 判据  |                                   $[A - \lambda I, \; B]$ 满秩                                    |                          $\begin{bmatrix} \mathbf{A} - \lambda I \\ \mathbf{C} \end{bmatrix}$ 满秩                           |

我们可以观察到，上面的结构中呈现出美妙的对称性。事实上，能控性与能观性之间存在深刻的对偶关系。具体而言，系统 $x_{k+1} = \mathbf{A} x_k + \mathbf{B} u_k$ 的能控性与系统 $x_{k+1} = \mathbf{A}^\top x_k + \mathbf{C}^\top u_k$ 的能观性是对偶的。换句话说，若 $(A,B)$ 组成的系统完全能控，则 $(A^\top,B^\top)$ 组成的系统完全能观，反之亦然。

不只是能控性和能观性，事实上控制器和观测器同样是对偶的。状态反馈控制器 $u_k = -\mathbf{K} x_k$ 通过调节增益矩阵 $\mathbf{K}$ 来影响系统动态，而状态观测器则通过设计观测增益矩阵 $\hat{x}_k = -\mathbf{L} y_k$ 来重构系统状态，控制器的调节方法（如极点配置、LQR）同样适用于观测器的设计（如极点配置观测器、LQE）。在实践中，我们应该**整体考虑系统的能控性与能观性**，以实现更优的控制与估计性能。
